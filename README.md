# Книга рецептов (Flask + JSON, JSON-редактирование ингредиентов)

Данное приложение представляет собой веб-сервис «Книга рецептов», где:

- **Добавление и редактирование рецептов** (название, категория, картинка, ингредиенты, шаги).  
- **Ингредиенты** хранятся в **JSON-поле** – при редактировании мы используем массив в JavaScript, а затем сериализуем его в одно поле `ingredients_json`, чтобы исключить проблемы с обрезкой/потерей.  
- **Фильтрация** по категории на главной (пункт «Все» + динамически собранные категории).  
- **Поиск** по названию/ингредиенту/категории (отдельная страница).  
- **Масштабирование** ингредиентов (временно, без сохранения).  
- **Данные** (рецепты) хранятся в JSON-файле `data/recipes.json`.  
- **Картинки** загружаются в папку `static/uploads/`.

---

## Функциональность

1. **Главная страница**:  
   - Список всех рецептов в виде таблицы.  
   - **Фильтр** по категории (выпадающий список + кнопка «Фильтр»).  
   - Кнопки «Редактировать», «Удалить», «Масштаб» и «Просмотр».  

2. **Добавление рецепта** (`/recipes/new`):  
   - Поля: Название, Категория, Шаги, Картинка.  
   - **Произвольное количество ингредиентов** – редактируются на фронтенде (JS) и отправляются одним полем `ingredients_json`.

3. **Редактирование рецепта** (`/recipes/<id>/edit`):  
   - Аналогично добавлению, только с заполненными начальными данными.  
   - Можно менять/добавлять/удалять ингредиенты, при сабмите сериализуются в JSON.

4. **Поиск** (`/search`):  
   - Поля: «Название (частично)», «Ингредиент (частично)», «Категория (точно)» (выпадающий список).  
   - Выдача в виде карточек (Bootstrap).

5. **Просмотр рецепта** (`/recipes/<id>`):  
   - Read-only информация (название, категория, шаги, ингредиенты, картинка).

6. **Масштабирование** (`/recipes/<id>/scale`):  
   - Позволяет умножить ингредиенты на указанный коэффициент «на лету» (без сохранения).

---

## Инструкции по установке и запуску

1. **Склонируйте репозиторий**:
   git clone https://github.com/<username>/cookbook-flask-json.git
   cd cookbook-flask-json
2. **Создайте (по желанию) виртуальное окружение и активируйте его**:
    python -m venv venv
    source venv/bin/activate    # Linux/Mac
    .\venv\Scripts\activate     # Windows
3. **Установите зависимости (Flask, etc.)**:
    pip install flask
4. **Убедитесь, что в папке `data/` есть файл `recipes.json`. Можно проинициализировать его пустым содержимым**:
    []
5. **Создайте папку `static/uploads/` (если её нет), где будут храниться загружаемые картинки**.
6. **Запустите приложение**:
    python app.py
7. **Откройте `http://127.0.0.1:5000` в браузере**.

---

## Скриншоты интерфейса (пример)

1. Главная страница с таблицей рецептов и выпадающим списком «Фильтр по категории»:

![Скриншот главной страницы](https://github.com/qisseyt/web_cookbook/raw/images/images/1.jpg)

2. Редактирование рецепта с JS-таблицей ингредиентов:

![Скриншот главной страницы](https://github.com/qisseyt/web_cookbook/raw/images/images/2.jpg)

3. Поиск с выбором категории, названием и ингредиентом:

![Скриншот главной страницы](https://github.com/qisseyt/web_cookbook/raw/images/images/3.jpg)

---

## Список использованных технологий

• Python 3.x
• Flask – веб-фреймворк
• Bootstrap 5 – стилизация (через CDN)
• Jinja2 (шаблонизатор Flask)
• Werkzeug (часть Flask) для загрузки файлов
• JSON (хранение данных в recipes.json)

---

## Архитектура приложения

Проект организован по «слоистой» схеме:

1. `models.py` – содержит классы Ingredient и Recipe.
2. `repository.py` – класс JSONRepository, реализующий чтение/запись в файл data/recipes.json (CRUD).
3. `service.py` – класс RecipeService: бизнес-логика (создание, редактирование, удаление, поиск, масштабирование).
4. `app.py` – Flask-приложение (маршруты @app.route):
    "/" (GET) – главная страница (список рецептов + фильтр по категории)
    "/search" (GET/POST) – страница поиска
    "/recipes/new" (GET/POST) – добавление рецепта
    "/recipes/<id>/edit" (GET/POST) – редактирование
    "/recipes/<id>/delete" (GET) – удаление
    "/recipes/<id>/scale" (POST) – временное масштабирование ингредиентов
    "/recipes/<id>" (GET) – просмотр конкретного рецепта
5. `templates/` – набор HTML-файлов с использованием Bootstrap и JavaScript:
    index.html – главная страница (таблица, фильтр категории).
    new.html, edit.html – JS-массив для ингредиентов, при сабмите сериализуем в ingredients_json.
    search.html – форма поиска, вывод карточек результатов.
    view.html – read-only просмотр.
    scaled_view.html – отображение временно масштабированного рецепта.
    layout.html – общий шаблон (navbar, стили).

Во время редактирования/добавления рецепта все ингредиенты хранятся в JavaScript-массиве на клиентской стороне и при сабмите отправляются одним полем ingredients_json, что исключает «обрезание» и «несохранение» ингредиентов.
